<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Combining datatables and sparkline</title>

<script src="libs/jquery-2.1.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.1/css/cosmo.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/respond.min.js"></script>
<script src="libs/htmlwidgets-0.5/htmlwidgets.js"></script>
<script src="libs/jquery-sparkline-2.1.2/jquery.sparkline.min.js"></script>
<script src="libs/sparkline-binding-1.0/sparkline.js"></script>
<script src="libs/datatables-binding-0.1/datatables.js"></script>
<script src="libs/datatables-1.10.7/jquery.dataTables.min.js"></script>
<link href="libs/datatables-default-1.10.7/dataTables.extra.css" rel="stylesheet" />
<link href="libs/datatables-default-1.10.7/jquery.dataTables.min.css" rel="stylesheet" />
<style type="text/css">
/* padding for bootstrap navbar */
body {
padding-top: 50px;
padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar) */
.section h2 {
padding-top: 55px;
margin-top: -55px;
}
.section h3 {
padding-top: 55px;
margin-top: -55px;
}
/* don't use link color in navbar */
.dropdown-menu>li>a {
color: black;
}
/* some padding for disqus */
#disqus_thread {
margin-top: 45px;
}
p {
  text-align: justify;
}
img.centered {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.jqstooltip {
  -webkit-box-sizing: content-box;
  -moz-box-sizing: content-box;
  box-sizing: content-box;
}

</style>
<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #303030; color: #cccccc; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #cccccc; background-color: #303030; }
code > span.kw { color: #f0dfaf; }
code > span.dt { color: #dfdfbf; }
code > span.dv { color: #dcdccc; }
code > span.bn { color: #dca3a3; }
code > span.fl { color: #c0bed1; }
code > span.ch { color: #dca3a3; }
code > span.st { color: #cc9393; }
code > span.co { color: #7f9f7f; }
code > span.ot { color: #efef8f; }
code > span.al { color: #ffcfaf; }
code > span.fu { color: #efef8f; }
code > span.er { color: #c3bf9f; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46129458-3', 'auto');
  ga('send', 'pageview');

</script>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">

<div class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R htmlwidgets examples</a>
      </div>
      <div class="navbar-collapse collapse navbar-responsive-collapse">
        <ul class="nav navbar-nav">
          <li><a href="ex_dt_sparkline.html">DT & Sparklines</a></li>

          <li><a href="http://leonawicz.github.io">All Projects</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <a class="btn btn-link" href="https://github.com/leonawicz/HtmlWidgetExamples">
            <i class="fa fa-github fa-lg"></i>
            Github
          </a>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>

<div id="header">
<h1 class="title">Combining datatables and sparkline</h1>
</div>


<div id="section" class="section level2">
<h2></h2>
</div>
<div id="section-1" class="section level2">
<h2></h2>
</div>
<div id="examples-using-fairbanks-alaska-climate" class="section level2">
<h2>Examples using Fairbanks, Alaska climate</h2>
<p>In the examples below, I use SNAP’s 2-km resolution downscaled CRU 3.2 temperature and precipitation data for Fairbanks, Alaska to demonstrate the use of the <code>DT</code> package for data tables and the <code>sparkline</code> package for in-line graphs as well as integration of sparkline in-line graphs into data tables. These packages make use of the <code>htmlwidgets</code> package and are interfaces to the jQuery plugins DataTables and Sparklines.</p>
<p>First, load data and required packages. I store the temperature range over all months and years for later use.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;C:/github/HtmlWidgetExamples/data/fai_temps.RData&quot;</span>)
<span class="kw">library</span>(data.table)
<span class="kw">library</span>(reshape2)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(DT)
<span class="kw">library</span>(sparkline)

fai &lt;-<span class="st"> </span><span class="kw">mutate</span>(fai, <span class="dt">Decade =</span> <span class="kw">paste0</span>(Year -<span class="st"> </span>Year%%<span class="dv">10</span>, <span class="st">&quot;s&quot;</span>))
r &lt;-<span class="st"> </span><span class="kw">range</span>(<span class="kw">filter</span>(fai, Var ==<span class="st"> &quot;Temperature&quot;</span>)$Val)</code></pre>
</div>
<div id="section-2" class="section level2">
<h2></h2>
</div>
<div id="section-3" class="section level2">
<h2></h2>
<div id="dt-data-tables" class="section level3">
<h3>DT data tables</h3>
<p>Here is the full data table.</p>
<pre class="sourceCode r"><code class="sourceCode r">fai</code></pre>
<pre><code>##                 Var          Location   Val Month Year Decade
##    1:   Temperature Fairbanks, Alaska -24.5   Jan 1901  1900s
##    2:   Temperature Fairbanks, Alaska -21.9   Feb 1901  1900s
##    3:   Temperature Fairbanks, Alaska -10.4   Mar 1901  1900s
##    4:   Temperature Fairbanks, Alaska  -2.7   Apr 1901  1900s
##    5:   Temperature Fairbanks, Alaska   7.6   May 1901  1900s
##   ---                                                        
## 2708: Precipitation Fairbanks, Alaska  57.0   Aug 2013  2010s
## 2709: Precipitation Fairbanks, Alaska  52.0   Sep 2013  2010s
## 2710: Precipitation Fairbanks, Alaska  11.0   Oct 2013  2010s
## 2711: Precipitation Fairbanks, Alaska  33.0   Nov 2013  2010s
## 2712: Precipitation Fairbanks, Alaska  18.0   Dec 2013  2010s</code></pre>
</div>
</div>
<div id="section-4" class="section level2">
<h2></h2>
<p>There are many options for displaying data table html wdigets in the browser using <code>DT</code>. See this tutorial for details.</p>
</div>
<div id="section-5" class="section level2">
<h2></h2>
</div>
<div id="section-6" class="section level2">
<h2></h2>
<div id="sparkline-in-line-graphs" class="section level3">
<h3>Sparkline in-line graphs</h3>
<pre class="sourceCode r"><code class="sourceCode r">fai.p &lt;-<span class="st"> </span><span class="kw">filter</span>(fai, Var ==<span class="st"> &quot;Precipitation&quot;</span> &amp;<span class="st"> </span>Decade ==<span class="st"> &quot;2000s&quot;</span> &amp;<span class="st"> </span>Month ==<span class="st"> &quot;Aug&quot;</span>)$Val
fai.p</code></pre>
<pre><code>##  [1] 86 56 85 55 10  8 61 42 74 76</code></pre>
</div>
</div>
<div id="section-7" class="section level2">
<h2></h2>
<p>Next, display some in-line graphs. Here I use August precipitation totals from Fairbanks each year from 2000 - 2009, stored in <code>fai.p</code>. In-line graphs can be shown with calls in your <code>R</code> Markdown document in the form <code>`r sparkline(fai.p)`</code>. Different plots can be made by passing a <code>type</code> argument, e.g., <code>`r sparkline(fai.p, type='bar')`</code>. Options include but are not limited to line graphs <span id="htmlwidget-7913" class="sparkline"></span>
<script type="application/json" data-for="htmlwidget-7913">{"x":{"values":[86,56,85,55,10,8,61,42,74,76],"options":{"height":20,"width":60},"width":60,"height":20},"evals":[]}</script>, bar graphs <span id="htmlwidget-9705" class="sparkline"></span>
<script type="application/json" data-for="htmlwidget-9705">{"x":{"values":[86,56,85,55,10,8,61,42,74,76],"options":{"type":"bar","height":20,"width":60},"width":60,"height":20},"evals":[]}</script>, and box plots <span id="htmlwidget-9651" class="sparkline"></span>
<script type="application/json" data-for="htmlwidget-9651">{"x":{"values":[86,56,85,55,10,8,61,42,74,76],"options":{"type":"box","height":20,"width":60},"width":60,"height":20},"evals":[]}</script>.</p>
</div>
<div id="section-8" class="section level2">
<h2></h2>
</div>
<div id="section-9" class="section level2">
<h2></h2>
<div id="sparklines-inside-data-tables" class="section level3">
<h3>Sparklines inside data tables</h3>
<p>To make things more interesting, I integrate sparklines into data tables. This requires providing column definitions and callback functions when making the tables. Here I provide two similar column definitions, the only difference being which columns to target (counting from zero because this refers to javascript, not <code>R</code>). These definitions add the <code>spark</code> class to the targeted columns.</p>
<pre class="sourceCode r"><code class="sourceCode r">colDefs1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">targets =</span> <span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">12</span>), <span class="dt">render =</span> <span class="kw">JS</span>(<span class="st">&quot;function(data, type, full){ return &#39;&lt;span class=spark&gt;&#39; + data + &#39;&lt;/span&gt;&#39; }&quot;</span>)))
colDefs2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">targets =</span> <span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">6</span>), <span class="dt">render =</span> <span class="kw">JS</span>(<span class="st">&quot;function(data, type, full){ return &#39;&lt;span class=spark&gt;&#39; + data + &#39;&lt;/span&gt;&#39; }&quot;</span>)))</code></pre>
</div>
</div>
<div id="section-10" class="section level2">
<h2></h2>
<p>I also define several callback functions, again all very similar. The only differences are minor tweaks to what I want the sparklines to look like. I make four data tables with sparklines, using lines, bars, and two with box plots. For some tables I use the range values from earlier to set a single y-axis common to each graph and for the others I allow each plot to have unique axis limits.</p>
<pre class="sourceCode r"><code class="sourceCode r">bar_string &lt;-<span class="st"> &quot;type: &#39;bar&#39;, barColor: &#39;orange&#39;, negBarColor: &#39;purple&#39;, highlightColor: &#39;black&#39;&quot;</span>
cb_bar =<span class="st"> </span><span class="kw">JS</span>(<span class="kw">paste0</span>(<span class="st">&quot;function (oSettings, json) { $(&#39;.spark:not(:has(canvas))&#39;).sparkline(&#39;html&#39;, { &quot;</span>, 
    bar_string, <span class="st">&quot; }); }&quot;</span>), <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)

line_string &lt;-<span class="st"> &quot;type: &#39;line&#39;, lineColor: &#39;black&#39;, fillColor: &#39;#ccc&#39;, highlightLineColor: &#39;orange&#39;, highlightSpotColor: &#39;orange&#39;&quot;</span>
cb_line =<span class="st"> </span><span class="kw">JS</span>(<span class="kw">paste0</span>(<span class="st">&quot;function (oSettings, json) { $(&#39;.spark:not(:has(canvas))&#39;).sparkline(&#39;html&#39;, { &quot;</span>, 
    line_string, <span class="st">&quot;, chartRangeMin: &quot;</span>, r[<span class="dv">1</span>], <span class="st">&quot;, chartRangeMax: &quot;</span>, r[<span class="dv">2</span>], <span class="st">&quot; }); }&quot;</span>), 
    <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)

box_string &lt;-<span class="st"> &quot;type: &#39;box&#39;, lineColor: &#39;black&#39;, whiskerColor: &#39;black&#39;, outlierFillColor: &#39;black&#39;, outlierLineColor: &#39;black&#39;, medianColor: &#39;black&#39;, boxFillColor: &#39;orange&#39;, boxLineColor: &#39;black&#39;&quot;</span>
cb_box1 =<span class="st"> </span><span class="kw">JS</span>(<span class="kw">paste0</span>(<span class="st">&quot;function (oSettings, json) { $(&#39;.spark:not(:has(canvas))&#39;).sparkline(&#39;html&#39;, { &quot;</span>, 
    box_string, <span class="st">&quot; }); }&quot;</span>), <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)
cb_box2 =<span class="st"> </span><span class="kw">JS</span>(<span class="kw">paste0</span>(<span class="st">&quot;function (oSettings, json) { $(&#39;.spark:not(:has(canvas))&#39;).sparkline(&#39;html&#39;, { &quot;</span>, 
    box_string, <span class="st">&quot;, chartRangeMin: &quot;</span>, r[<span class="dv">1</span>], <span class="st">&quot;, chartRangeMax: &quot;</span>, r[<span class="dv">2</span>], <span class="st">&quot; }); }&quot;</span>), 
    <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)</code></pre>
</div>
<div id="section-11" class="section level2">
<h2></h2>
<p>Notice that the call to <code>summarise</code> below does collapse the data over years (grouped by decades and months), but nothing is lost because the values are concatenated into single character strings. <code>dcast</code> is used to return the table to wide format for a more convenient display.</p>
<pre class="sourceCode r"><code class="sourceCode r">fai.t &lt;-<span class="st"> </span>fai %&gt;%<span class="st"> </span><span class="kw">filter</span>(Var ==<span class="st"> &quot;Temperature&quot;</span> &amp;<span class="st"> </span>Year &gt;=<span class="st"> </span><span class="dv">1950</span> &amp;<span class="st"> </span>Year &lt;<span class="st"> </span><span class="dv">2010</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">group_by</span>(Decade, Month) %&gt;%<span class="st"> </span><span class="kw">summarise</span>(<span class="dt">Temperature =</span> <span class="kw">paste</span>(Val, <span class="dt">collapse =</span> <span class="st">&quot;,&quot;</span>))
fai.ta &lt;-<span class="st"> </span><span class="kw">dcast</span>(fai.t, Decade ~<span class="st"> </span>Month)
fai.tb &lt;-<span class="st"> </span><span class="kw">dcast</span>(fai.t, Month ~<span class="st"> </span>Decade)</code></pre>
</div>
<div id="section-12" class="section level2">
<h2></h2>
</div>
<div id="section-13" class="section level2">
<h2></h2>
<div id="example-tables" class="section level4">
<h4>Example tables</h4>
<p>In the tables below, I have not excluded the option to sort rows by specific columns, because this is a nice feature of data tables I wish to show. However, as far as I can tell, the DataTables library does not do anything intelligent when required to sort table rows by a column containing sparklines. Also, the twelve months in the first column are levels of a factor in <code>R</code> but the javascript DataTables library sees this as a simple character string. Ideally sorting should be disallowed unless it can be restricted to reverse of what is listed initially.</p>
<p>Plot temperature line graphs with a decades by months layout. This table shows sparklines which all share a common y-axis. It is not easy to read given the data. Sparklines are most often used in-line among text, though in-line in a table is really no different and can in fact only make them easier to juxtapose and compare. Nevertheless, they work best when the interest is in obtaining a sense for variability in a signal at a glance. By their nature they will not work as well for making comparisons between sparklines.</p>
<pre class="sourceCode r"><code class="sourceCode r">d1 &lt;-<span class="st"> </span><span class="kw">datatable</span>(<span class="kw">data.table</span>(fai.ta), <span class="dt">rownames =</span> <span class="ot">FALSE</span>, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">columnDefs =</span> colDefs1, 
    <span class="dt">fnDrawCallback =</span> cb_line))
d1$dependencies &lt;-<span class="st"> </span><span class="kw">append</span>(d1$dependencies, htmlwidgets:::<span class="kw">getDependency</span>(<span class="st">&quot;sparkline&quot;</span>))
d1</code></pre>
<p><div id="htmlwidget-2813" style="width:100%;height:auto;" class="datatables"></div>
<script type="application/json" data-for="htmlwidget-2813">{"x":{"data":[["1950s","1960s","1970s","1980s","1990s","2000s"],["-17.8,-29.2,-27.8,-27.6,-25,-18.7,-28.1,-16.2,-18.6,-28.1","-19.3,-18.2,-21.3,-16.3,-25.6,-26.9,-31.9,-25.5,-23.2,-31.7","-26.1,-31.2,-26.2,-27.2,-26.3,-25.7,-23.3,-13.4,-17,-21.1","-22.4,-10,-27,-23.3,-20.4,-12.3,-18.1,-16.7,-19.9,-28.9","-24.1,-19.5,-19.6,-19.2,-17.9,-22.2,-26.5,-26,-24.4,-26.3","-22.3,-12.8,-14.9,-18.8,-25.7,-21.9,-29,-20.8,-22,-23.2"],["-25.5,-21.3,-18.5,-15.5,-26.3,-23.7,-22.9,-18.5,-16.4,-13.7","-15.2,-19.5,-13.2,-17.1,-16.7,-26.5,-21.2,-20.8,-19.6,-21","-13.9,-19.6,-22.7,-18,-26.5,-19,-24.6,-12.3,-14.9,-30.4","-12.2,-14.2,-19.3,-15.3,-24.5,-22.4,-14.6,-16.2,-15,-15.1","-28.3,-17.7,-21.8,-15.6,-20.6,-17.1,-19.1,-12.6,-15.8,-24.7","-12.9,-13.1,-17.4,-12.1,-16.4,-18.3,-13.8,-20.6,-19.7,-17.8"],["-7.9,-17.8,-12.6,-13.3,-11,-12,-14.2,-7.7,-8.8,-18.7","-15.2,-17.2,-13.2,-13.2,-18.7,-5,-18.7,-12.1,-10.3,-11.8","-7.5,-16.8,-18.1,-11.1,-13.4,-10.7,-11.1,-15.2,-9.8,-11","-8.1,-3.5,-10.4,-10.2,-6.8,-9.6,-14.3,-10.3,-7.8,-13.9","-7.4,-11.1,-9.8,-8,-11.7,-15.2,-8.7,-15,-7.3,-13.1","-7.9,-11.8,-11.9,-12.6,-13.8,-6.3,-15.2,-17.5,-9,-14"],["-1.9,1.2,-2.4,2.7,-3.3,-5.2,-0.6,0.1,1.3,-3.5","-3,-4,-1.2,-4.2,-3.6,-0.7,-2.9,-0.4,-1.7,2.2","-0.2,-3.1,-5.7,1.5,1.3,-1.1,1.9,-2.4,1.4,-0.8","1.9,-0.6,-2.7,2.6,-1.2,-6.4,-4.7,1.3,0.7,2.1","3.2,1.7,-3.5,3.9,1.3,4.3,0.4,1.6,3.5,0.1","-0.1,0.8,-4.9,0.6,1.5,0.2,-1.3,3,-1,-0.7"],["8.6,9.6,5.4,10.7,10.2,7.7,9.1,9.1,9,8.4","11.6,9.5,7,9.5,4.9,6,7.3,7.5,8.6,9.6","10.9,8.4,8.4,10.2,10.6,11.7,8.7,9.2,10,9.9","10.4,10.7,8.1,10,8.3,8.1,8.6,10.3,11.4,8.7","12.6,10.7,5.5,12,10.8,11.9,9.4,9.6,10.1,8.4","7,6.9,10.2,8.5,11.3,13.2,10.1,10.6,9.9,11"],["14.8,13.8,14.5,16.4,14.7,13,14.1,17.6,16.9,16.2","13.2,14.7,14.6,12.1,15.4,12.8,17.2,16.3,15.1,17.9","14.2,17.2,15,15.5,14.6,17.1,15.1,15.1,12.5,13.9","13.5,14.7,14.5,16.5,16.2,14,16.7,16.3,16.9,15.4","16.2,17.5,15.4,16.5,14.5,15.8,15.2,17,14.8,16.3","16.1,16.2,14.5,15.8,19,16.2,14.5,16.4,15.5,15.8"],["16.2,15.4,15.2,16.3,14.3,15.9,15.8,15.5,16.6,13.5","16.2,14.8,17,15.2,15,15.3,16.4,15,18.3,14.7","16.4,15.7,17.6,16.2,17,18.9,16.1,16.6,17,15.9","15.7,14.1,16.8,17.3,15.6,16.8,17,17.3,18.2,17.6","18.1,15.4,17.3,18.2,17.8,16.8,16.9,17.7,16.8,16","15.3,15.2,16.2,15.8,17.7,16.4,16.1,17.7,15.7,18.8"],["14.2,14.3,12.1,13.2,13.6,11.6,13.1,15.1,13.6,12.4","12.7,12.8,14.3,12.6,13.5,11.5,13.7,14.4,14.6,10","13.7,13.2,14.8,12.7,14.9,13.3,15,16.8,15.1,15.7","12,12,13.5,11.8,12,13.3,12.5,14.2,14.5,15.9","15.3,12.3,13.5,13.2,15.2,13.8,11.8,14.8,11.9,14.5","11.5,14.1,12.5,13.4,16.8,14.2,12.6,16,12.7,12.8"],["8,8.1,5.6,7.1,5.7,6.2,5.3,6.2,5.9,6.1","5,6.4,5,8.5,6.9,8.7,9.7,7.8,5.7,9.2","4.6,6.7,4.2,8.2,10.1,7.4,7.1,7.3,7.9,7.9","5.8,6.4,9.2,4.7,7.9,5.8,7.6,6.4,6.6,8.9","6.9,8.6,3.8,6.4,6.4,10.7,5.3,9.7,7.7,7.2","5.2,8.5,8.4,5.6,5.1,7.9,9.6,8.2,8.1,8.9"],["-3.1,-5.1,-0.4,-4.1,0,-4.3,-7.8,-1.2,-7.4,-4.1","-2.8,-5.7,-0.4,-2.8,-1.7,-7.8,-4,-3.7,-5.1,1.2","-7,-2.1,-2.5,-3.6,-5.5,-4.2,-4.2,-3.1,-4.5,0.2","0.7,-1.2,-7.3,-4.5,-3.2,-6.6,-2.4,0.9,-7.2,-2.9","-4.1,-3.6,-7.7,-1.1,-5.7,-1.9,-8.5,-6.8,-2.9,-5.9","-4.8,-4.9,0.2,0.7,-0.9,-2,0.3,-5.5,-6.5,-0.4"],["-19.7,-10.2,-7.9,-15.3,-9.5,-21.9,-19.1,-9.5,-15.7,-12.9","-17,-17.9,-14,-20.3,-15.1,-14.4,-16.2,-11.3,-15.2,-15.9","-11.9,-16.4,-12.7,-17,-16.3,-20.2,-8.1,-19.1,-11.8,-6.6","-10.3,-10,-14.3,-11.8,-16.7,-19.1,-16.5,-13.3,-18.4,-20.5","-19.5,-16.2,-10.9,-12,-16.5,-18.1,-17.6,-10.6,-13.7,-18.9","-11.8,-16.2,-7.1,-11.5,-12.7,-18.1,-20,-10,-17.1,-16.9"],["-21.1,-22.3,-19.8,-20.4,-29.9,-23.2,-29.1,-26.7,-22.1,-23.4","-15.1,-29.4,-21.7,-16.3,-30,-25.9,-28.9,-19.1,-27.8,-15.8","-23.6,-21.4,-19.7,-19.9,-24.5,-27,-20.2,-26.3,-16.5,-23.8","-29.8,-20.5,-17,-20.2,-20,-13.8,-14.5,-19.8,-15.8,-15.6","-21.7,-19.7,-22.3,-17.7,-22.7,-23.1,-25.5,-21.4,-21,-24.7","-17.9,-23.8,-15.2,-23.1,-20,-17.6,-19.2,-19.8,-22.3,-20.1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Decade</th>\n      <th>Jan</th>\n      <th>Feb</th>\n      <th>Mar</th>\n      <th>Apr</th>\n      <th>May</th>\n      <th>Jun</th>\n      <th>Jul</th>\n      <th>Aug</th>\n      <th>Sep</th>\n      <th>Oct</th>\n      <th>Nov</th>\n      <th>Dec</th>\n    </tr>\n  </thead>\n</table>","options":{"columnDefs":[{"targets":[1,2,3,4,5,6,7,8,9,10,11,12],"render":"function(data, type, full){ return '<span class=spark>' + data + '</span>' }"}],"fnDrawCallback":"function (oSettings, json) { $('.spark:not(:has(canvas))').sparkline('html', { type: 'line', lineColor: 'black', fillColor: '#ccc', highlightLineColor: 'orange', highlightSpotColor: 'orange', chartRangeMin: -32.6, chartRangeMax: 19 }); }\n","order":[],"autoWidth":false,"orderClasses":false},"callback":null,"filter":"none"},"evals":["options.columnDefs.0.render","options.fnDrawCallback"]}</script></p>
</div>
</div>
<div id="section-14" class="section level2">
<h2></h2>
<p>Plot bar graphs using a months by decades layout. In this case I allow individual sparklines to have unique y-axis limits. They are much easier to read, but in this case the focus is more clearly not on comparing across months or decades.</p>
<pre class="sourceCode r"><code class="sourceCode r">d2 &lt;-<span class="st"> </span><span class="kw">datatable</span>(<span class="kw">data.table</span>(fai.tb), <span class="dt">rownames =</span> <span class="ot">FALSE</span>, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">columnDefs =</span> colDefs2, 
    <span class="dt">fnDrawCallback =</span> cb_bar))
d2$dependencies &lt;-<span class="st"> </span><span class="kw">append</span>(d2$dependencies, htmlwidgets:::<span class="kw">getDependency</span>(<span class="st">&quot;sparkline&quot;</span>))
d2</code></pre>
<p><div id="htmlwidget-3721" style="width:100%;height:auto;" class="datatables"></div>
<script type="application/json" data-for="htmlwidget-3721">{"x":{"data":[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["-17.8,-29.2,-27.8,-27.6,-25,-18.7,-28.1,-16.2,-18.6,-28.1","-25.5,-21.3,-18.5,-15.5,-26.3,-23.7,-22.9,-18.5,-16.4,-13.7","-7.9,-17.8,-12.6,-13.3,-11,-12,-14.2,-7.7,-8.8,-18.7","-1.9,1.2,-2.4,2.7,-3.3,-5.2,-0.6,0.1,1.3,-3.5","8.6,9.6,5.4,10.7,10.2,7.7,9.1,9.1,9,8.4","14.8,13.8,14.5,16.4,14.7,13,14.1,17.6,16.9,16.2","16.2,15.4,15.2,16.3,14.3,15.9,15.8,15.5,16.6,13.5","14.2,14.3,12.1,13.2,13.6,11.6,13.1,15.1,13.6,12.4","8,8.1,5.6,7.1,5.7,6.2,5.3,6.2,5.9,6.1","-3.1,-5.1,-0.4,-4.1,0,-4.3,-7.8,-1.2,-7.4,-4.1","-19.7,-10.2,-7.9,-15.3,-9.5,-21.9,-19.1,-9.5,-15.7,-12.9","-21.1,-22.3,-19.8,-20.4,-29.9,-23.2,-29.1,-26.7,-22.1,-23.4"],["-19.3,-18.2,-21.3,-16.3,-25.6,-26.9,-31.9,-25.5,-23.2,-31.7","-15.2,-19.5,-13.2,-17.1,-16.7,-26.5,-21.2,-20.8,-19.6,-21","-15.2,-17.2,-13.2,-13.2,-18.7,-5,-18.7,-12.1,-10.3,-11.8","-3,-4,-1.2,-4.2,-3.6,-0.7,-2.9,-0.4,-1.7,2.2","11.6,9.5,7,9.5,4.9,6,7.3,7.5,8.6,9.6","13.2,14.7,14.6,12.1,15.4,12.8,17.2,16.3,15.1,17.9","16.2,14.8,17,15.2,15,15.3,16.4,15,18.3,14.7","12.7,12.8,14.3,12.6,13.5,11.5,13.7,14.4,14.6,10","5,6.4,5,8.5,6.9,8.7,9.7,7.8,5.7,9.2","-2.8,-5.7,-0.4,-2.8,-1.7,-7.8,-4,-3.7,-5.1,1.2","-17,-17.9,-14,-20.3,-15.1,-14.4,-16.2,-11.3,-15.2,-15.9","-15.1,-29.4,-21.7,-16.3,-30,-25.9,-28.9,-19.1,-27.8,-15.8"],["-26.1,-31.2,-26.2,-27.2,-26.3,-25.7,-23.3,-13.4,-17,-21.1","-13.9,-19.6,-22.7,-18,-26.5,-19,-24.6,-12.3,-14.9,-30.4","-7.5,-16.8,-18.1,-11.1,-13.4,-10.7,-11.1,-15.2,-9.8,-11","-0.2,-3.1,-5.7,1.5,1.3,-1.1,1.9,-2.4,1.4,-0.8","10.9,8.4,8.4,10.2,10.6,11.7,8.7,9.2,10,9.9","14.2,17.2,15,15.5,14.6,17.1,15.1,15.1,12.5,13.9","16.4,15.7,17.6,16.2,17,18.9,16.1,16.6,17,15.9","13.7,13.2,14.8,12.7,14.9,13.3,15,16.8,15.1,15.7","4.6,6.7,4.2,8.2,10.1,7.4,7.1,7.3,7.9,7.9","-7,-2.1,-2.5,-3.6,-5.5,-4.2,-4.2,-3.1,-4.5,0.2","-11.9,-16.4,-12.7,-17,-16.3,-20.2,-8.1,-19.1,-11.8,-6.6","-23.6,-21.4,-19.7,-19.9,-24.5,-27,-20.2,-26.3,-16.5,-23.8"],["-22.4,-10,-27,-23.3,-20.4,-12.3,-18.1,-16.7,-19.9,-28.9","-12.2,-14.2,-19.3,-15.3,-24.5,-22.4,-14.6,-16.2,-15,-15.1","-8.1,-3.5,-10.4,-10.2,-6.8,-9.6,-14.3,-10.3,-7.8,-13.9","1.9,-0.6,-2.7,2.6,-1.2,-6.4,-4.7,1.3,0.7,2.1","10.4,10.7,8.1,10,8.3,8.1,8.6,10.3,11.4,8.7","13.5,14.7,14.5,16.5,16.2,14,16.7,16.3,16.9,15.4","15.7,14.1,16.8,17.3,15.6,16.8,17,17.3,18.2,17.6","12,12,13.5,11.8,12,13.3,12.5,14.2,14.5,15.9","5.8,6.4,9.2,4.7,7.9,5.8,7.6,6.4,6.6,8.9","0.7,-1.2,-7.3,-4.5,-3.2,-6.6,-2.4,0.9,-7.2,-2.9","-10.3,-10,-14.3,-11.8,-16.7,-19.1,-16.5,-13.3,-18.4,-20.5","-29.8,-20.5,-17,-20.2,-20,-13.8,-14.5,-19.8,-15.8,-15.6"],["-24.1,-19.5,-19.6,-19.2,-17.9,-22.2,-26.5,-26,-24.4,-26.3","-28.3,-17.7,-21.8,-15.6,-20.6,-17.1,-19.1,-12.6,-15.8,-24.7","-7.4,-11.1,-9.8,-8,-11.7,-15.2,-8.7,-15,-7.3,-13.1","3.2,1.7,-3.5,3.9,1.3,4.3,0.4,1.6,3.5,0.1","12.6,10.7,5.5,12,10.8,11.9,9.4,9.6,10.1,8.4","16.2,17.5,15.4,16.5,14.5,15.8,15.2,17,14.8,16.3","18.1,15.4,17.3,18.2,17.8,16.8,16.9,17.7,16.8,16","15.3,12.3,13.5,13.2,15.2,13.8,11.8,14.8,11.9,14.5","6.9,8.6,3.8,6.4,6.4,10.7,5.3,9.7,7.7,7.2","-4.1,-3.6,-7.7,-1.1,-5.7,-1.9,-8.5,-6.8,-2.9,-5.9","-19.5,-16.2,-10.9,-12,-16.5,-18.1,-17.6,-10.6,-13.7,-18.9","-21.7,-19.7,-22.3,-17.7,-22.7,-23.1,-25.5,-21.4,-21,-24.7"],["-22.3,-12.8,-14.9,-18.8,-25.7,-21.9,-29,-20.8,-22,-23.2","-12.9,-13.1,-17.4,-12.1,-16.4,-18.3,-13.8,-20.6,-19.7,-17.8","-7.9,-11.8,-11.9,-12.6,-13.8,-6.3,-15.2,-17.5,-9,-14","-0.1,0.8,-4.9,0.6,1.5,0.2,-1.3,3,-1,-0.7","7,6.9,10.2,8.5,11.3,13.2,10.1,10.6,9.9,11","16.1,16.2,14.5,15.8,19,16.2,14.5,16.4,15.5,15.8","15.3,15.2,16.2,15.8,17.7,16.4,16.1,17.7,15.7,18.8","11.5,14.1,12.5,13.4,16.8,14.2,12.6,16,12.7,12.8","5.2,8.5,8.4,5.6,5.1,7.9,9.6,8.2,8.1,8.9","-4.8,-4.9,0.2,0.7,-0.9,-2,0.3,-5.5,-6.5,-0.4","-11.8,-16.2,-7.1,-11.5,-12.7,-18.1,-20,-10,-17.1,-16.9","-17.9,-23.8,-15.2,-23.1,-20,-17.6,-19.2,-19.8,-22.3,-20.1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Month</th>\n      <th>1950s</th>\n      <th>1960s</th>\n      <th>1970s</th>\n      <th>1980s</th>\n      <th>1990s</th>\n      <th>2000s</th>\n    </tr>\n  </thead>\n</table>","options":{"columnDefs":[{"targets":[1,2,3,4,5,6],"render":"function(data, type, full){ return '<span class=spark>' + data + '</span>' }"}],"fnDrawCallback":"function (oSettings, json) { $('.spark:not(:has(canvas))').sparkline('html', { type: 'bar', barColor: 'orange', negBarColor: 'purple', highlightColor: 'black' }); }\n","order":[],"autoWidth":false,"orderClasses":false},"callback":null,"filter":"none"},"evals":["options.columnDefs.0.render","options.fnDrawCallback"]}</script></p>
</div>
<div id="section-15" class="section level2">
<h2></h2>
<p>Plot bar graphs using a months by decades layout. The two versions below differ in their axis settings. The first allows unique chart ranges like the previous bar graph. The second fixes all sparklines to a single range.</p>
<pre class="sourceCode r"><code class="sourceCode r">d3 &lt;-<span class="st"> </span><span class="kw">datatable</span>(<span class="kw">data.table</span>(fai.tb), <span class="dt">rownames =</span> <span class="ot">FALSE</span>, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">columnDefs =</span> colDefs2, 
    <span class="dt">fnDrawCallback =</span> cb_box1))
d3$dependencies &lt;-<span class="st"> </span><span class="kw">append</span>(d3$dependencies, htmlwidgets:::<span class="kw">getDependency</span>(<span class="st">&quot;sparkline&quot;</span>))
d3</code></pre>
<p><div id="htmlwidget-143" style="width:100%;height:auto;" class="datatables"></div>
<script type="application/json" data-for="htmlwidget-143">{"x":{"data":[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["-17.8,-29.2,-27.8,-27.6,-25,-18.7,-28.1,-16.2,-18.6,-28.1","-25.5,-21.3,-18.5,-15.5,-26.3,-23.7,-22.9,-18.5,-16.4,-13.7","-7.9,-17.8,-12.6,-13.3,-11,-12,-14.2,-7.7,-8.8,-18.7","-1.9,1.2,-2.4,2.7,-3.3,-5.2,-0.6,0.1,1.3,-3.5","8.6,9.6,5.4,10.7,10.2,7.7,9.1,9.1,9,8.4","14.8,13.8,14.5,16.4,14.7,13,14.1,17.6,16.9,16.2","16.2,15.4,15.2,16.3,14.3,15.9,15.8,15.5,16.6,13.5","14.2,14.3,12.1,13.2,13.6,11.6,13.1,15.1,13.6,12.4","8,8.1,5.6,7.1,5.7,6.2,5.3,6.2,5.9,6.1","-3.1,-5.1,-0.4,-4.1,0,-4.3,-7.8,-1.2,-7.4,-4.1","-19.7,-10.2,-7.9,-15.3,-9.5,-21.9,-19.1,-9.5,-15.7,-12.9","-21.1,-22.3,-19.8,-20.4,-29.9,-23.2,-29.1,-26.7,-22.1,-23.4"],["-19.3,-18.2,-21.3,-16.3,-25.6,-26.9,-31.9,-25.5,-23.2,-31.7","-15.2,-19.5,-13.2,-17.1,-16.7,-26.5,-21.2,-20.8,-19.6,-21","-15.2,-17.2,-13.2,-13.2,-18.7,-5,-18.7,-12.1,-10.3,-11.8","-3,-4,-1.2,-4.2,-3.6,-0.7,-2.9,-0.4,-1.7,2.2","11.6,9.5,7,9.5,4.9,6,7.3,7.5,8.6,9.6","13.2,14.7,14.6,12.1,15.4,12.8,17.2,16.3,15.1,17.9","16.2,14.8,17,15.2,15,15.3,16.4,15,18.3,14.7","12.7,12.8,14.3,12.6,13.5,11.5,13.7,14.4,14.6,10","5,6.4,5,8.5,6.9,8.7,9.7,7.8,5.7,9.2","-2.8,-5.7,-0.4,-2.8,-1.7,-7.8,-4,-3.7,-5.1,1.2","-17,-17.9,-14,-20.3,-15.1,-14.4,-16.2,-11.3,-15.2,-15.9","-15.1,-29.4,-21.7,-16.3,-30,-25.9,-28.9,-19.1,-27.8,-15.8"],["-26.1,-31.2,-26.2,-27.2,-26.3,-25.7,-23.3,-13.4,-17,-21.1","-13.9,-19.6,-22.7,-18,-26.5,-19,-24.6,-12.3,-14.9,-30.4","-7.5,-16.8,-18.1,-11.1,-13.4,-10.7,-11.1,-15.2,-9.8,-11","-0.2,-3.1,-5.7,1.5,1.3,-1.1,1.9,-2.4,1.4,-0.8","10.9,8.4,8.4,10.2,10.6,11.7,8.7,9.2,10,9.9","14.2,17.2,15,15.5,14.6,17.1,15.1,15.1,12.5,13.9","16.4,15.7,17.6,16.2,17,18.9,16.1,16.6,17,15.9","13.7,13.2,14.8,12.7,14.9,13.3,15,16.8,15.1,15.7","4.6,6.7,4.2,8.2,10.1,7.4,7.1,7.3,7.9,7.9","-7,-2.1,-2.5,-3.6,-5.5,-4.2,-4.2,-3.1,-4.5,0.2","-11.9,-16.4,-12.7,-17,-16.3,-20.2,-8.1,-19.1,-11.8,-6.6","-23.6,-21.4,-19.7,-19.9,-24.5,-27,-20.2,-26.3,-16.5,-23.8"],["-22.4,-10,-27,-23.3,-20.4,-12.3,-18.1,-16.7,-19.9,-28.9","-12.2,-14.2,-19.3,-15.3,-24.5,-22.4,-14.6,-16.2,-15,-15.1","-8.1,-3.5,-10.4,-10.2,-6.8,-9.6,-14.3,-10.3,-7.8,-13.9","1.9,-0.6,-2.7,2.6,-1.2,-6.4,-4.7,1.3,0.7,2.1","10.4,10.7,8.1,10,8.3,8.1,8.6,10.3,11.4,8.7","13.5,14.7,14.5,16.5,16.2,14,16.7,16.3,16.9,15.4","15.7,14.1,16.8,17.3,15.6,16.8,17,17.3,18.2,17.6","12,12,13.5,11.8,12,13.3,12.5,14.2,14.5,15.9","5.8,6.4,9.2,4.7,7.9,5.8,7.6,6.4,6.6,8.9","0.7,-1.2,-7.3,-4.5,-3.2,-6.6,-2.4,0.9,-7.2,-2.9","-10.3,-10,-14.3,-11.8,-16.7,-19.1,-16.5,-13.3,-18.4,-20.5","-29.8,-20.5,-17,-20.2,-20,-13.8,-14.5,-19.8,-15.8,-15.6"],["-24.1,-19.5,-19.6,-19.2,-17.9,-22.2,-26.5,-26,-24.4,-26.3","-28.3,-17.7,-21.8,-15.6,-20.6,-17.1,-19.1,-12.6,-15.8,-24.7","-7.4,-11.1,-9.8,-8,-11.7,-15.2,-8.7,-15,-7.3,-13.1","3.2,1.7,-3.5,3.9,1.3,4.3,0.4,1.6,3.5,0.1","12.6,10.7,5.5,12,10.8,11.9,9.4,9.6,10.1,8.4","16.2,17.5,15.4,16.5,14.5,15.8,15.2,17,14.8,16.3","18.1,15.4,17.3,18.2,17.8,16.8,16.9,17.7,16.8,16","15.3,12.3,13.5,13.2,15.2,13.8,11.8,14.8,11.9,14.5","6.9,8.6,3.8,6.4,6.4,10.7,5.3,9.7,7.7,7.2","-4.1,-3.6,-7.7,-1.1,-5.7,-1.9,-8.5,-6.8,-2.9,-5.9","-19.5,-16.2,-10.9,-12,-16.5,-18.1,-17.6,-10.6,-13.7,-18.9","-21.7,-19.7,-22.3,-17.7,-22.7,-23.1,-25.5,-21.4,-21,-24.7"],["-22.3,-12.8,-14.9,-18.8,-25.7,-21.9,-29,-20.8,-22,-23.2","-12.9,-13.1,-17.4,-12.1,-16.4,-18.3,-13.8,-20.6,-19.7,-17.8","-7.9,-11.8,-11.9,-12.6,-13.8,-6.3,-15.2,-17.5,-9,-14","-0.1,0.8,-4.9,0.6,1.5,0.2,-1.3,3,-1,-0.7","7,6.9,10.2,8.5,11.3,13.2,10.1,10.6,9.9,11","16.1,16.2,14.5,15.8,19,16.2,14.5,16.4,15.5,15.8","15.3,15.2,16.2,15.8,17.7,16.4,16.1,17.7,15.7,18.8","11.5,14.1,12.5,13.4,16.8,14.2,12.6,16,12.7,12.8","5.2,8.5,8.4,5.6,5.1,7.9,9.6,8.2,8.1,8.9","-4.8,-4.9,0.2,0.7,-0.9,-2,0.3,-5.5,-6.5,-0.4","-11.8,-16.2,-7.1,-11.5,-12.7,-18.1,-20,-10,-17.1,-16.9","-17.9,-23.8,-15.2,-23.1,-20,-17.6,-19.2,-19.8,-22.3,-20.1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Month</th>\n      <th>1950s</th>\n      <th>1960s</th>\n      <th>1970s</th>\n      <th>1980s</th>\n      <th>1990s</th>\n      <th>2000s</th>\n    </tr>\n  </thead>\n</table>","options":{"columnDefs":[{"targets":[1,2,3,4,5,6],"render":"function(data, type, full){ return '<span class=spark>' + data + '</span>' }"}],"fnDrawCallback":"function (oSettings, json) { $('.spark:not(:has(canvas))').sparkline('html', { type: 'box', lineColor: 'black', whiskerColor: 'black', outlierFillColor: 'black', outlierLineColor: 'black', medianColor: 'black', boxFillColor: 'orange', boxLineColor: 'black' }); }\n","order":[],"autoWidth":false,"orderClasses":false},"callback":null,"filter":"none"},"evals":["options.columnDefs.0.render","options.fnDrawCallback"]}</script></p>
<pre class="sourceCode r"><code class="sourceCode r">d4 &lt;-<span class="st"> </span><span class="kw">datatable</span>(<span class="kw">data.table</span>(fai.tb), <span class="dt">rownames =</span> <span class="ot">FALSE</span>, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">columnDefs =</span> colDefs2, 
    <span class="dt">fnDrawCallback =</span> cb_box2))
d4$dependencies &lt;-<span class="st"> </span><span class="kw">append</span>(d4$dependencies, htmlwidgets:::<span class="kw">getDependency</span>(<span class="st">&quot;sparkline&quot;</span>))
d4</code></pre>
<p><div id="htmlwidget-382" style="width:100%;height:auto;" class="datatables"></div>
<script type="application/json" data-for="htmlwidget-382">{"x":{"data":[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["-17.8,-29.2,-27.8,-27.6,-25,-18.7,-28.1,-16.2,-18.6,-28.1","-25.5,-21.3,-18.5,-15.5,-26.3,-23.7,-22.9,-18.5,-16.4,-13.7","-7.9,-17.8,-12.6,-13.3,-11,-12,-14.2,-7.7,-8.8,-18.7","-1.9,1.2,-2.4,2.7,-3.3,-5.2,-0.6,0.1,1.3,-3.5","8.6,9.6,5.4,10.7,10.2,7.7,9.1,9.1,9,8.4","14.8,13.8,14.5,16.4,14.7,13,14.1,17.6,16.9,16.2","16.2,15.4,15.2,16.3,14.3,15.9,15.8,15.5,16.6,13.5","14.2,14.3,12.1,13.2,13.6,11.6,13.1,15.1,13.6,12.4","8,8.1,5.6,7.1,5.7,6.2,5.3,6.2,5.9,6.1","-3.1,-5.1,-0.4,-4.1,0,-4.3,-7.8,-1.2,-7.4,-4.1","-19.7,-10.2,-7.9,-15.3,-9.5,-21.9,-19.1,-9.5,-15.7,-12.9","-21.1,-22.3,-19.8,-20.4,-29.9,-23.2,-29.1,-26.7,-22.1,-23.4"],["-19.3,-18.2,-21.3,-16.3,-25.6,-26.9,-31.9,-25.5,-23.2,-31.7","-15.2,-19.5,-13.2,-17.1,-16.7,-26.5,-21.2,-20.8,-19.6,-21","-15.2,-17.2,-13.2,-13.2,-18.7,-5,-18.7,-12.1,-10.3,-11.8","-3,-4,-1.2,-4.2,-3.6,-0.7,-2.9,-0.4,-1.7,2.2","11.6,9.5,7,9.5,4.9,6,7.3,7.5,8.6,9.6","13.2,14.7,14.6,12.1,15.4,12.8,17.2,16.3,15.1,17.9","16.2,14.8,17,15.2,15,15.3,16.4,15,18.3,14.7","12.7,12.8,14.3,12.6,13.5,11.5,13.7,14.4,14.6,10","5,6.4,5,8.5,6.9,8.7,9.7,7.8,5.7,9.2","-2.8,-5.7,-0.4,-2.8,-1.7,-7.8,-4,-3.7,-5.1,1.2","-17,-17.9,-14,-20.3,-15.1,-14.4,-16.2,-11.3,-15.2,-15.9","-15.1,-29.4,-21.7,-16.3,-30,-25.9,-28.9,-19.1,-27.8,-15.8"],["-26.1,-31.2,-26.2,-27.2,-26.3,-25.7,-23.3,-13.4,-17,-21.1","-13.9,-19.6,-22.7,-18,-26.5,-19,-24.6,-12.3,-14.9,-30.4","-7.5,-16.8,-18.1,-11.1,-13.4,-10.7,-11.1,-15.2,-9.8,-11","-0.2,-3.1,-5.7,1.5,1.3,-1.1,1.9,-2.4,1.4,-0.8","10.9,8.4,8.4,10.2,10.6,11.7,8.7,9.2,10,9.9","14.2,17.2,15,15.5,14.6,17.1,15.1,15.1,12.5,13.9","16.4,15.7,17.6,16.2,17,18.9,16.1,16.6,17,15.9","13.7,13.2,14.8,12.7,14.9,13.3,15,16.8,15.1,15.7","4.6,6.7,4.2,8.2,10.1,7.4,7.1,7.3,7.9,7.9","-7,-2.1,-2.5,-3.6,-5.5,-4.2,-4.2,-3.1,-4.5,0.2","-11.9,-16.4,-12.7,-17,-16.3,-20.2,-8.1,-19.1,-11.8,-6.6","-23.6,-21.4,-19.7,-19.9,-24.5,-27,-20.2,-26.3,-16.5,-23.8"],["-22.4,-10,-27,-23.3,-20.4,-12.3,-18.1,-16.7,-19.9,-28.9","-12.2,-14.2,-19.3,-15.3,-24.5,-22.4,-14.6,-16.2,-15,-15.1","-8.1,-3.5,-10.4,-10.2,-6.8,-9.6,-14.3,-10.3,-7.8,-13.9","1.9,-0.6,-2.7,2.6,-1.2,-6.4,-4.7,1.3,0.7,2.1","10.4,10.7,8.1,10,8.3,8.1,8.6,10.3,11.4,8.7","13.5,14.7,14.5,16.5,16.2,14,16.7,16.3,16.9,15.4","15.7,14.1,16.8,17.3,15.6,16.8,17,17.3,18.2,17.6","12,12,13.5,11.8,12,13.3,12.5,14.2,14.5,15.9","5.8,6.4,9.2,4.7,7.9,5.8,7.6,6.4,6.6,8.9","0.7,-1.2,-7.3,-4.5,-3.2,-6.6,-2.4,0.9,-7.2,-2.9","-10.3,-10,-14.3,-11.8,-16.7,-19.1,-16.5,-13.3,-18.4,-20.5","-29.8,-20.5,-17,-20.2,-20,-13.8,-14.5,-19.8,-15.8,-15.6"],["-24.1,-19.5,-19.6,-19.2,-17.9,-22.2,-26.5,-26,-24.4,-26.3","-28.3,-17.7,-21.8,-15.6,-20.6,-17.1,-19.1,-12.6,-15.8,-24.7","-7.4,-11.1,-9.8,-8,-11.7,-15.2,-8.7,-15,-7.3,-13.1","3.2,1.7,-3.5,3.9,1.3,4.3,0.4,1.6,3.5,0.1","12.6,10.7,5.5,12,10.8,11.9,9.4,9.6,10.1,8.4","16.2,17.5,15.4,16.5,14.5,15.8,15.2,17,14.8,16.3","18.1,15.4,17.3,18.2,17.8,16.8,16.9,17.7,16.8,16","15.3,12.3,13.5,13.2,15.2,13.8,11.8,14.8,11.9,14.5","6.9,8.6,3.8,6.4,6.4,10.7,5.3,9.7,7.7,7.2","-4.1,-3.6,-7.7,-1.1,-5.7,-1.9,-8.5,-6.8,-2.9,-5.9","-19.5,-16.2,-10.9,-12,-16.5,-18.1,-17.6,-10.6,-13.7,-18.9","-21.7,-19.7,-22.3,-17.7,-22.7,-23.1,-25.5,-21.4,-21,-24.7"],["-22.3,-12.8,-14.9,-18.8,-25.7,-21.9,-29,-20.8,-22,-23.2","-12.9,-13.1,-17.4,-12.1,-16.4,-18.3,-13.8,-20.6,-19.7,-17.8","-7.9,-11.8,-11.9,-12.6,-13.8,-6.3,-15.2,-17.5,-9,-14","-0.1,0.8,-4.9,0.6,1.5,0.2,-1.3,3,-1,-0.7","7,6.9,10.2,8.5,11.3,13.2,10.1,10.6,9.9,11","16.1,16.2,14.5,15.8,19,16.2,14.5,16.4,15.5,15.8","15.3,15.2,16.2,15.8,17.7,16.4,16.1,17.7,15.7,18.8","11.5,14.1,12.5,13.4,16.8,14.2,12.6,16,12.7,12.8","5.2,8.5,8.4,5.6,5.1,7.9,9.6,8.2,8.1,8.9","-4.8,-4.9,0.2,0.7,-0.9,-2,0.3,-5.5,-6.5,-0.4","-11.8,-16.2,-7.1,-11.5,-12.7,-18.1,-20,-10,-17.1,-16.9","-17.9,-23.8,-15.2,-23.1,-20,-17.6,-19.2,-19.8,-22.3,-20.1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Month</th>\n      <th>1950s</th>\n      <th>1960s</th>\n      <th>1970s</th>\n      <th>1980s</th>\n      <th>1990s</th>\n      <th>2000s</th>\n    </tr>\n  </thead>\n</table>","options":{"columnDefs":[{"targets":[1,2,3,4,5,6],"render":"function(data, type, full){ return '<span class=spark>' + data + '</span>' }"}],"fnDrawCallback":"function (oSettings, json) { $('.spark:not(:has(canvas))').sparkline('html', { type: 'box', lineColor: 'black', whiskerColor: 'black', outlierFillColor: 'black', outlierLineColor: 'black', medianColor: 'black', boxFillColor: 'orange', boxLineColor: 'black', chartRangeMin: -32.6, chartRangeMax: 19 }); }\n","order":[],"autoWidth":false,"orderClasses":false},"callback":null,"filter":"none"},"evals":["options.columnDefs.0.render","options.fnDrawCallback"]}</script></p>
</div>
<div id="section-16" class="section level2">
<h2></h2>
</div>
<div id="section-17" class="section level2">
<h2></h2>
<div id="a-more-useful-table" class="section level4">
<h4>A more useful table</h4>
<p>Generally I would not use a table as a complete substitute for a plot. In cases where I can, it is because the data set is simple enough that a traditional text table will suffice. If adding sparklines to a table, my preference is to use them to enhance a particular column or two, which otherwise remains a standard data table, rather than turn it into a “many-paneled plot”.</p>
<p>The above examples are for illustration. The table below seems like a good mix of data tables and sparklines. This time I also grouped by location, month, and climate variable even though they are constants in this data subset. This retains them in the final data table for display purposes. I think it gives a better picture of what the table would look like with more columns which are not all narrow-width and numeric-valued.</p>
<p>In the column definitions and the callback function, note the use of <code>.sparkSeries</code> and <code>.sparkSamples</code> to differentiate which type of sparklines are placed in each of the two columns. The box plot shows the distribution of values over a decade whereas the time series line gives a sense of whether any trend is present. Although it is a simple example and each individual plot is based on only ten values, it reveals how each in-line graph type draws the eye to different properties of the data and both are a nice compliment to the original data table.</p>
<pre class="sourceCode r"><code class="sourceCode r">fai.t2 &lt;-<span class="st"> </span>fai %&gt;%<span class="st"> </span><span class="kw">filter</span>(Var ==<span class="st"> &quot;Temperature&quot;</span> &amp;<span class="st"> </span>Month ==<span class="st"> &quot;Aug&quot;</span> &amp;<span class="st"> </span>Year &gt;=<span class="st"> </span><span class="dv">1950</span> &amp;<span class="st"> </span>
<span class="st">    </span>Year &lt;<span class="st"> </span><span class="dv">2010</span>) %&gt;%<span class="st"> </span><span class="kw">group_by</span>(Location, Month, Var, Decade) %&gt;%<span class="st"> </span><span class="kw">summarise</span>(<span class="dt">Mean =</span> <span class="kw">round</span>(<span class="kw">mean</span>(Val), 
    <span class="dv">1</span>), <span class="dt">SD =</span> <span class="kw">round</span>(<span class="kw">sd</span>(Val), <span class="dv">2</span>), <span class="dt">Min =</span> <span class="kw">min</span>(Val), <span class="dt">Max =</span> <span class="kw">max</span>(Val), <span class="dt">Samples =</span> <span class="kw">paste</span>(Val, 
    <span class="dt">collapse =</span> <span class="st">&quot;,&quot;</span>)) %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Series =</span> Samples) %&gt;%<span class="st"> </span>data.table

cd &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">targets =</span> <span class="dv">8</span>, <span class="dt">render =</span> <span class="kw">JS</span>(<span class="st">&quot;function(data, type, full){ return &#39;&lt;span class=sparkSamples&gt;&#39; + data + &#39;&lt;/span&gt;&#39; }&quot;</span>)), 
    <span class="kw">list</span>(<span class="dt">targets =</span> <span class="dv">9</span>, <span class="dt">render =</span> <span class="kw">JS</span>(<span class="st">&quot;function(data, type, full){ return &#39;&lt;span class=sparkSeries&gt;&#39; + data + &#39;&lt;/span&gt;&#39; }&quot;</span>)))

cb =<span class="st"> </span><span class="kw">JS</span>(<span class="kw">paste0</span>(<span class="st">&quot;function (oSettings, json) {</span><span class="ch">\n</span><span class="st">  $(&#39;.sparkSeries:not(:has(canvas))&#39;).sparkline(&#39;html&#39;, { &quot;</span>, 
    line_string, <span class="st">&quot; });</span><span class="ch">\n</span><span class="st">  $(&#39;.sparkSamples:not(:has(canvas))&#39;).sparkline(&#39;html&#39;, { &quot;</span>, 
    box_string, <span class="st">&quot; });</span><span class="ch">\n</span><span class="st">}&quot;</span>), <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)</code></pre>
</div>
</div>
<div id="section-18" class="section level2">
<h2></h2>
<p>This strikes a nice balance. On the one hand, I could add additional columns to the table such as the median and quartiles, but I don’t need to add these columns because I can hover over the box plot and see those values in the tooltip. I can also see information about outliers. This alleviates the need for additional columns. I cannot look at trends easily, or at all, in a summary table. I can only do this if I use a full table and summarise nothing. For this reason the time series plots are also helpful.</p>
<p>On the other hand, I could remove all my value columns, but I definitely do not want to. Technically speaking, I can get the medians from the samples column using the box plots, which are close enough to the means, and the min and max values from the series column in-line graphs. Neither plot type specifically provides the standard deviation, but perhaps seeing the distribution in a box plot is “better” in some instances anyhow, like if the data were highly skewed. Ultimately, I do not want to be required to hover over all these little plots to essentially decrypt my table. I want to look at a table and see numbers without any intermediary mental decoding.</p>
<pre class="sourceCode r"><code class="sourceCode r">d5 &lt;-<span class="st"> </span><span class="kw">datatable</span>(<span class="kw">data.table</span>(fai.t2), <span class="dt">rownames =</span> <span class="ot">FALSE</span>, <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">columnDefs =</span> cd, 
    <span class="dt">fnDrawCallback =</span> cb))
d5$dependencies &lt;-<span class="st"> </span><span class="kw">append</span>(d5$dependencies, htmlwidgets:::<span class="kw">getDependency</span>(<span class="st">&quot;sparkline&quot;</span>))
d5</code></pre>
<p><div id="htmlwidget-875" style="width:100%;height:auto;" class="datatables"></div>
<script type="application/json" data-for="htmlwidget-875">{"x":{"data":[["Fairbanks, Alaska","Fairbanks, Alaska","Fairbanks, Alaska","Fairbanks, Alaska","Fairbanks, Alaska","Fairbanks, Alaska"],["Aug","Aug","Aug","Aug","Aug","Aug"],["Temperature","Temperature","Temperature","Temperature","Temperature","Temperature"],["1950s","1960s","1970s","1980s","1990s","2000s"],[13.3,13,14.5,13.2,13.6,13.7],[1.08,1.43,1.27,1.37,1.32,1.66],[11.6,10,12.7,11.8,11.8,11.5],[15.1,14.6,16.8,15.9,15.3,16.8],["14.2,14.3,12.1,13.2,13.6,11.6,13.1,15.1,13.6,12.4","12.7,12.8,14.3,12.6,13.5,11.5,13.7,14.4,14.6,10","13.7,13.2,14.8,12.7,14.9,13.3,15,16.8,15.1,15.7","12,12,13.5,11.8,12,13.3,12.5,14.2,14.5,15.9","15.3,12.3,13.5,13.2,15.2,13.8,11.8,14.8,11.9,14.5","11.5,14.1,12.5,13.4,16.8,14.2,12.6,16,12.7,12.8"],["14.2,14.3,12.1,13.2,13.6,11.6,13.1,15.1,13.6,12.4","12.7,12.8,14.3,12.6,13.5,11.5,13.7,14.4,14.6,10","13.7,13.2,14.8,12.7,14.9,13.3,15,16.8,15.1,15.7","12,12,13.5,11.8,12,13.3,12.5,14.2,14.5,15.9","15.3,12.3,13.5,13.2,15.2,13.8,11.8,14.8,11.9,14.5","11.5,14.1,12.5,13.4,16.8,14.2,12.6,16,12.7,12.8"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Location</th>\n      <th>Month</th>\n      <th>Var</th>\n      <th>Decade</th>\n      <th>Mean</th>\n      <th>SD</th>\n      <th>Min</th>\n      <th>Max</th>\n      <th>Samples</th>\n      <th>Series</th>\n    </tr>\n  </thead>\n</table>","options":{"columnDefs":[{"targets":8,"render":"function(data, type, full){ return '<span class=sparkSamples>' + data + '</span>' }"},{"targets":9,"render":"function(data, type, full){ return '<span class=sparkSeries>' + data + '</span>' }"},{"className":"dt-right","targets":[4,5,6,7]}],"fnDrawCallback":"function (oSettings, json) {\n  $('.sparkSeries:not(:has(canvas))').sparkline('html', { type: 'line', lineColor: 'black', fillColor: '#ccc', highlightLineColor: 'orange', highlightSpotColor: 'orange' });\n  $('.sparkSamples:not(:has(canvas))').sparkline('html', { type: 'box', lineColor: 'black', whiskerColor: 'black', outlierFillColor: 'black', outlierLineColor: 'black', medianColor: 'black', boxFillColor: 'orange', boxLineColor: 'black' });\n}\n","order":[],"autoWidth":false,"orderClasses":false},"callback":null,"filter":"none"},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.fnDrawCallback"]}</script></p>
<p>This is why I see the integration of sparklines inside data tables as complimentary to other information in a table, but not generally as a full replacement where the table becomes a series of pictures, requiring human interaction with all the individual table cells in order to obtain certain types of information.</p>
<p>To make a simile, the numeric data columns are like open doorways to an aggregation of the data. The box plots are more like closed doors. You have to fuss with them as a user to obtain similar information. The time series graphs are more like locked doors in this context. You can figure out the mean from them, but doing so is ridiculous. However, the box plots and time series lines are each open doors to disaggregated information from the original data set, where the summary statistics in the numeric columns are more like closed doors. More complete distributional information and data at a more disaggregated scale can seamlessly be piped through into the summary table where it would normally never be visible.</p>
<p>The right balance allows for the most information to be immediately accessible. Some information, like a specific statistic, is best shown as a clearly visible number. Other information like the distribution of a random variable, a trend line, an expression of variability around a trend through time, or some other functional form, can be most quickly interpreted from a visual description.</p>
</div>

<!-- some extra javascript for older browsers -->
<script type="text/javascript" src="libs/polyfill.js"></script>
<script>
  // manage active state of menu based on current page
  $(document).ready(function () {
  
    // active menu
    href = window.location.pathname
    href = href.substr(href.lastIndexOf('/') + 1)
    $('a[href="' + href + '"]').parent().addClass('active');
    
    // manage active menu header
    if (href.startsWith('authoring_'))
      $('a[href="' + 'authoring' + '"]').parent().addClass('active');
    else if (href.endsWith('_format.html'))
      $('a[href="' + 'formats' + '"]').parent().addClass('active');
    else if (href.startsWith('developer_'))
      $('a[href="' + 'developer' + '"]').parent().addClass('active');
	  
  });
</script>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
